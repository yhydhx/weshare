{% extends "frontEnd/base.html" %}<!-- 继承基础模板 -->
{% load staticfiles %}<!-- 加载全局变量 -->

{% block body %}
<style>
    body{
        background-color:white;  
    }
</style>

    <div class="container" style="margin-top: 60px;">
    	<div class="row">
    		<div class="col-md-2" style="text-align:center;">
    			<div class="row centerLeftbarIcon"><img src="{{ current_user.icon }}" style="height: 100px; width: 100px; border: 1px solid #cccccc; border-radius: 50%;"></div>
    			<div class="row centerLeftbarButton"><a href="/host_center/edit" style="color:black;">修改信息</a></div> 
    			<div class="row centerLeftbarButton"><a href="/host_center/manage">订单管理</a></div>

                {% if current_user.state == 0 %}
                <div class="row centerLeftbarButton"><a href="/image-receive/">注册HOST</a></div>
                {% elif current_user.state == 1 %}
                <div class="row centerLeftbarButton"><a href="/host_center/auth">更新主页</a></div>
                {% elif current_user.state == 2 %}
                <div class="row centerLeftbarButton"><a href="/host_center/edit2">更新主页</a></div>
                <div class="row centerLeftbarButton"><a href="/host_center/auth">申请认证</a></div>
                {% endif %}
    		</div>
    		<div class="col-md-10">

                <div class="row" style="display: flex;align-items: center; padding-top:30px; padding-bottom: 30px; ">
                    <div class="col-xs-4"><hr></div>
                    <div class="col-xs-4" style="text-align:center;">
                        <h4>提交认证资料</h4>
                    </div>
                    <div class="col-xs-4"><hr></div>
                </div>

                <form id="auth" onsubmit="updateAuth();return false">
                    {% csrf_token %}
                    <div class="panel" style="text-align: left; ">
                      <div class="panel-heading" style="height:50px;">

                        <div class="form-group">
                            <div class="col-xs-4">
                              <input type="text" class="form-control" name="c_name" placeholder="请输入认证名称">
                            </div>
                            <div class="col-xs-8">
                              <input type="text" class="form-control" name="c_introduction" placeholder="请输入认证描述，如：ACM世界排名第一">
                            </div>
                        </div>
                        
                      </div>
                      <div class="panel-body">
                        <div class="row">
                            <div class="col-md-10">
                                <a href="" class="btn btn-primary"  onclick="upload.click(); return false;">上传资料</a><span style="padding-left: 20px; "> 支持：jpg、png、pdf  &nbsp;&nbsp;</span>
                                <input type="text" id="upfile"> 
                                <input type="text" id="upfileType" name="c_type">
                                <input type="file" id="upload" name="certification" accept=".jpg,.png,.pdf" style="display:none" onchange="upfile.value=this.value;upfileType.value=this.value.substr(this.value.indexOf('.'));">
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-danger">添加</button>
                            </div>
                        </div>
                      </div>
                    </div>
                </form>
                <div id="uploadMessage"> <!-- 显示提交文件后的返回信息 --></div>


                <div class="row" style="display: flex;align-items: center; padding-top:30px; padding-bottom: 30px; ">
                    <div class="col-xs-4"><hr></div>
                    <div class="col-xs-4" style="text-align:center;">
                        <h4>已提交的资料</h4>
                    </div>
                    <div class="col-xs-4"><hr></div>
                </div>


                <div class="panel" style="text-align: left; ">
                  <div class="panel-heading" style="height:50px;">
                    <div class="row">
                        <div class="col-xs-1 control-label"><h4>①</h4></div>
                        <div class="col-xs-3">
                          认证名称：ACM
                        </div>
                        <div class="col-xs-8">
                          认证描述：ACM世界第一
                        </div>
                    </div>
                  </div>
                  <div class="panel-body">
                    <div class="row">
                        <div class="col-md-5">
                            <img data-toggle="lightbox" src="{% static 'frontEnd/images/weshare/Imax1.jpg' %}" data-image="{% static 'frontEnd/images/weshare/Imax1.jpg' %}" data-caption="认证图片" class="img-thumbnail" alt="还未上传认证图片" width="200">
                        </div>
                        <div class="col-md-5">
                            状态：审核中...
                        </div>
                        <div class="col-md-2">
                            <a href="" class="btn btn-success">编辑</a>
                            <a href="" class="btn btn-danger">删除</a>
                        </div>
                    </div>
                  </div>
                </div>

                


    		</div>
    	</div>
    </div>

{% endblock %}

{% block js %}

<script>
function updateAuth(){

    var formData = new FormData($( "#auth" )[0]);
    console.log(formData);
    $.ajax({
        url : "/host_center/auth",
        type : "POST",
        data : formData,
        async: false,  
        cache: false,  
        contentType: false,  
        processData: false,
        success : function(str){
            console.log('成功');
            console.log(str['message']);
            $('#uploadMessage').append(str['message']);
        },
        error : function(err){
            console.log('失败');
            console.log(err);
            $('#uploadMessage').append(str['message']);
        }

    })

}
</script>
{% endblock %}